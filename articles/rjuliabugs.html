<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with rjuliabugs: A Step-by-Step Logistic Regression Example with Random Effects ‚Ä¢ rjuliabugs</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with rjuliabugs: A Step-by-Step Logistic Regression Example with Random Effects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rjuliabugs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/rjuliabugs.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/rjuliabugs_parallel.html">rjuliabugs_parallel</a></li>
    <li><a class="dropdown-item" href="../articles/setup_troubleshooting.html">setup_troubleshooting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting Started with rjuliabugs: A Step-by-Step Logistic Regression Example with Random Effects</h1>
            
      

      <div class="d-none name"><code>rjuliabugs.Rmd</code></div>
    </div>

    
    
<p>This document provides a complete walkthrough for fitting a simple
logistic regression model with random effects using the
<code>rjuliabugs</code> package. Rather than focusing on deep
statistical analysis, the main goal of this guide is to demonstrate how
to use the functionality offered by <code>rjuliabugs</code> to fit BUGS
models from R by leveraging modern probabilistic programming tools
available in Julia.</p>
<p>In particular, <code>rjuliabugs</code> allows users to fit models
using advanced samplers such as Hamiltonian Monte Carlo (HMC) and
automatic differentiation, as implemented in <code>JuliaBUGS</code>.
This integration brings the power and flexibility of modern Bayesian
computation into the R ecosystem with full compatibility of well know
packages as <code>bayesplot</code>, <code>coda</code>,
<code>posterior</code> which provide nice and neat visualizations and
diagnosticis for a full Bayesian workflow.</p>
<p>For more technical details about <code>JuliaBUGS</code>, please refer
to <a href="https://github.com/TuringLang/JuliaBUGS.jl" class="external-link">this link</a>.
To learn more about probabilistic programming in Julia, we also
recommend the <a href="https://turinglang.org/" class="external-link">Turing.jl</a>
project.</p>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>This vignette assumes that <code>rjuliabugs</code> has already been
correctly installed and set up. The goal here is to provide a working
example under the assumption that your installation is functional.</p>
<p>For detailed installation instructions and troubleshooting
information, please refer to the <a href="https://github.com/MateusMaiaDS/rjuliabugs/" class="external-link">README</a>. The
installation guide includes the following sections:</p>
<ul>
<li><a href="#installing-julia">Installing Julia</a></li>
<li>
<a href="#troubleshooting-juliacall-setup">Troubleshooting JuliaCall
setup</a>
<ul>
<li><a href="#error-type-julia-not-found">Julia not found</a></li>
<li><a href="#error-type-r_home-not-found">R not found</a></li>
<li><a href="#other-installation-issues">Other installation
issues</a></li>
</ul>
</li>
<li><a href="#using-rjuliabugs-in-parallel">Using
<code>rjuliabugs</code> in parallel</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>To demonstrate a first example, we will use the same dataset
presented in the official <code>JuliaBUGS</code> illustration. The case
concerns the proportion of seeds that germinated on each of 21 plates.
To work with this data, we need to create a named list in R that
contains all the variables required by the model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">23</span>, <span class="fl">23</span>, <span class="fl">26</span>, <span class="fl">17</span>, <span class="fl">5</span>, <span class="fl">53</span>, <span class="fl">55</span>, <span class="fl">32</span>, <span class="fl">46</span>, <span class="fl">10</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">8</span>, <span class="fl">23</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">22</span>, <span class="fl">15</span>, <span class="fl">32</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">39</span>, <span class="fl">62</span>, <span class="fl">81</span>, <span class="fl">51</span>, <span class="fl">39</span>, <span class="fl">6</span>, <span class="fl">74</span>, <span class="fl">72</span>, <span class="fl">51</span>, <span class="fl">79</span>, <span class="fl">13</span>, <span class="fl">16</span>, <span class="fl">30</span>, <span class="fl">28</span>, <span class="fl">45</span>, <span class="fl">4</span>, <span class="fl">12</span>, <span class="fl">41</span>, <span class="fl">30</span>, <span class="fl">51</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>    x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    N <span class="op">=</span> <span class="fl">21</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Users already familiar with fitting models using <code>JAGS</code> or
<code>Stan</code> will recognize the structure of passing a named list
as the data input for the model. Here, we follow the same
convention.</p>
<p>One important disclaimer concerns the definition and use of numeric
values, particularly integers. When specifying an integer in the data
list, make sure it is not written with a decimal point. For example, if
a variable like <code>N</code> (e.g., the total number of plates) is
defined as <code>21.0</code> instead of <code>21</code>,
<code>JuliaCall</code> will automatically convert it as a
<code>Float</code>, which may lead to an error if the model expects an
<code>Integer</code>. Always use strict integer values when required by
the model.</p>
<p>Inspecting closely each element we have <code>r[i]</code> as the
number of germinated seeds and <code>n[i]</code> as the total number of
seeds on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
plate. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_{i}</annotation></semantics></math>
be the probability of germination on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
plate. Then, the model is defined by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">logit</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>Œ±</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Œ±</mi><mn>1</mn></msub><msub><mi>x</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>Œ±</mi><mn>2</mn></msub><msub><mi>x</mi><mrow><mn>2</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>Œ±</mi><mn>12</mn></msub><msub><mi>x</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><msub><mi>x</mi><mrow><mn>2</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>b</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>‚àº</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>œÑ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>r</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>‚àº</mo><mtext mathvariant="normal">Binomial</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo>,</mo><msub><mi>n</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\text{logit}(p_i) &amp;= \alpha_0 + \alpha_1 x_{1i} + \alpha_2 x_{2i} + \alpha_{12} x_{1i} x_{2i} + b_i \\
b_i &amp;\sim \mathcal{N}(0, \tau) \\
r_i &amp;\sim \text{Binomial}(p_i, n_i)
\end{aligned}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">x_{1i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mn>2</mn><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">x_{2i}</annotation></semantics></math>
are the seed type and root extract of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
plate.</p>
</div>
<div class="section level2">
<h2 id="bugs-model">BUGS model<a class="anchor" aria-label="anchor" href="#bugs-model"></a>
</h2>
<p>Once we have our data prepared, we can define the model using the
original BUGS syntax. In <code>rjuliabugs</code>, we write the model as
a string in R, following the same structure used in other R packages
that interface with BUGS-like tools:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_def</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">model {</span></span>
<span><span class="st">    for (i in 1:N) {</span></span>
<span><span class="st">        r[i] ~ dbin(p[i], n[i])</span></span>
<span><span class="st">        b[i] ~ dnorm(0.0, tau)</span></span>
<span><span class="st">        logit(p[i]) &lt;- alpha0 + alpha1 * x1[i] + alpha2 * x2[i] +</span></span>
<span><span class="st">                       alpha12 * x1[i] * x2[i] + b[i]</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">    alpha0 ~ dnorm(0.0, 1.0E-6)</span></span>
<span><span class="st">    alpha1 ~ dnorm(0.0, 1.0E-6)</span></span>
<span><span class="st">    alpha2 ~ dnorm(0.0, 1.0E-6)</span></span>
<span><span class="st">    alpha12 ~ dnorm(0.0, 1.0E-6)</span></span>
<span><span class="st">    tau ~ dgamma(0.001, 0.001)</span></span>
<span><span class="st">    sigma &lt;- 1 / sqrt(tau)</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>Users familiar with R packages like <code>R2jags</code>,
<code>rjags</code>, or <code>R2WinBUGS</code> will recognize this
approach: the model is defined as a string using the BUGS modeling
language. For users coming from Stan (e.g., via <code>rstan</code> or
<code>cmdstanr</code>), the idea is similar: the model is written as a
probabilistic program inside a string object, then compiled and executed
by the backend.</p>
<p>This syntactic similarity is not accidental. It is a design choice of
<code>rjuliabugs</code>, which aims to allow users to reuse models
originally written for <code>JAGS</code> or <code>WinBUGS</code>, while
taking advantage of modern features available in Julia‚Äîsuch as
Hamiltonian Monte Carlo and automatic differentiation‚Äîvia
<code>JuliaBUGS</code>.</p>
<p>We also remind users that they should be familiar with the
<code>BUGS</code> syntax, as syntax-related mistakes will lead to errors
during model compilation. For additional guidance, see the <a href="https://turinglang.org/JuliaBUGS.jl/v0.9/BUGS_notes/" class="external-link">Miscellaneous
Notes on BUGS</a> from the JuliaBUGS documentation, as well as the <a href="https://turinglang.org/JuliaBUGS.jl/v0.9/BUGS_notes/" class="external-link">BUGS
Developer Manual</a>.</p>
<p>For example, writing <code>1.0E-6.0</code> instead of
<code>1.0E-6</code> is a syntax error in BUGS, even though the numerical
meaning is equivalent. These types of issues can be subtle but will
cause the model to fail during parsing, so attention to detail when
writing BUGS code is important.</p>
</div>
<div class="section level2">
<h2 id="inference-running-the-sampler">Inference / Running the Sampler<a class="anchor" aria-label="anchor" href="#inference-running-the-sampler"></a>
</h2>
<p>Once the data is defined and the model is set up, we can run the
sampler to perform inference. The setup for the HMC sampler uses
Not-U-Turn Sampler (NUTS) with the target acceptance probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ¥</mi><mo>=</mo><mn>0.8</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\delta=0.8)</annotation></semantics></math>
for step size adaptation. This is done using the main function,
<code>juliaBUGS</code>. For example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mateusmaiads.github.io/rjuliabugs/">rjuliabugs</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/juliaBUGS.html">juliaBUGS</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  model_def <span class="op">=</span> <span class="va">model_def</span>,</span>
<span>  params_to_save <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha0"</span>, <span class="st">"alpha1"</span>, <span class="st">"alpha2"</span>, <span class="st">"alpha12"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  n_warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  n_discard <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  n_chain <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  use_parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_thin <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Preparing JuliaBUGS setup... DONE!</span></span>
<span><span class="co">#&gt; Initialising AbstractMCMC.sample()... DONE!</span></span></code></pre></div>
<p>This will return the MCMC chains, and a brief inspection can be done
through <code>summary</code> function</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generating the summary of the code</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">posterior</span>,get_summary <span class="op">=</span> <span class="cn">FALSE</span>,get_quantiles <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of JuliaBUGS sampler:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iterations        = 3000</span></span>
<span><span class="co">#&gt; Number of chains  = 4</span></span>
<span><span class="co">#&gt; Number of posterior samples = 2000</span></span>
<span><span class="co">#&gt; Thinning parameter = 1</span></span>
<span><span class="co">#&gt; Samples per chain = 1001:3000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary Statistics:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  parameters      mean      std      mcse ess_bulk ess_tail  rhat ess_per_sec</span></span>
<span><span class="co">#&gt;         tau 50.159335 145.0744 15.456188      293      146 1.016          NA</span></span>
<span><span class="co">#&gt;     alpha12 -0.828159   0.4434  0.008390     2755     4439 1.001          NA</span></span>
<span><span class="co">#&gt;      alpha2  1.353300   0.2772  0.005020     3025     3852 1.002          NA</span></span>
<span><span class="co">#&gt;      alpha1  0.080401   0.3152  0.006335     2468     4290 1.002          NA</span></span>
<span><span class="co">#&gt;      alpha0 -0.548857   0.1944  0.003617     2885     3588 1.001          NA</span></span>
<span><span class="co">#&gt;        b[1] -0.203235   0.2688  0.006624     1736     3583 1.003          NA</span></span>
<span><span class="co">#&gt;        b[2]  0.004103   0.2212  0.002931     5805     4637 1.005          NA</span></span>
<span><span class="co">#&gt;        b[3] -0.206592   0.2394  0.006092     1603     4283 1.004          NA</span></span>
<span><span class="co">#&gt;        b[4]  0.278762   0.2608  0.007187     1299     4351 1.003          NA</span></span>
<span><span class="co">#&gt;        b[5]  0.118124   0.2394  0.003791     4088     5359 1.002          NA</span></span>
<span><span class="co">#&gt;          ...</span></span>
<span><span class="co">#&gt;   17 rows omitted</span></span></code></pre></div>
<p>If we wish to obtain the summary statistics for each saved parameter,
we can set the argument <code>get_summary = TRUE</code> when calling
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>. Additionally, to include the quantiles
associated with the posterior distributions, set
<code>get_quantiles = TRUE</code>. To inspect only the summary output in
the same format as displayed in <code>JuliaBUGS</code>, set
<code>julia_summary_only = TRUE</code>. This will return the native
Julia-style summary.</p>
<p>For further details, see the documentation by running
<code><a href="../reference/summary.rjuliabugs.html">?summary.rjuliabugs</a></code>.</p>
</div>
<div class="section level2">
<h2 id="inspecting-the-posterior-samples">Inspecting the Posterior Samples<a class="anchor" aria-label="anchor" href="#inspecting-the-posterior-samples"></a>
</h2>
<p>Once sampling is done, the <code>juliaBUGS</code> function returns an
object of class <code>rjuliabugs</code>. This object contains:</p>
<ul>
<li><p><code>params</code><br>
Posterior samples, in the format specified by
<code>posterior_type</code>. These are the parameters defined to be
saved in the argument <code>params_to_save</code>. The format of this
object depends on the prior definition of the argument
<code>posterior_type</code> when calling <code>juliaBUGS</code>. The
default is <code>"array"</code>, which is compatible with most R
libraries that work with posterior samples, and returns a 3D numeric
array (iterations √ó chains √ó parameters). Other available types are
<code>"rvar"</code>, <code>"mcmc"</code>, and <code>"draws"</code>. See
<code><a href="../reference/juliaBUGS.html">?juliaBUGS</a></code> for more details.</p></li>
<li><p><code>name</code><br>
Character string identifying the Julia sampler object. As mentioned
before, <code>rjuliabugs</code> relies heavily on <code>JuliaCall</code>
to integrate the R interface with Julia. While using the package, a
Julia session runs in the background and generates the
<code>Chains</code> object containing all posterior samples, which can
be accessed through the <code>name</code> argument. This name can be
defined when calling <code>juliaBUGS</code> through the
<code>name</code> parameter and serves as the key to retrieve the fitted
sampler. If <code>juliaBUGS</code> is called multiple times with the
same name, <code>rjuliabugs</code> automatically generates a new unique
name to avoid overwriting. To delete a fitted model object from the
Julia environment, call <code><a href="../reference/delete_julia_obj.html">delete_julia_obj()</a></code> with the
corresponding name. See <code><a href="../reference/delete_julia_obj.html">?delete_julia_obj</a></code> for more
details.</p></li>
<li><p><code>sampler</code><br>
Sampler object returned by <code>AbstractMCMC.sample</code>. This is a
Julia object of type <code>"JuliaObject"</code>. For more details, see
the documentation of <code>julia_call()</code> in the
<code>JuliaCall</code> package.</p></li>
<li><p><code>n_threads</code><br>
Number of Julia threads detected. This is important to verify whether
Julia properly recognized the available threads and if the sampler ran
in parallel correctly. If you set <code>parallel = TRUE</code> when
calling <code>juliaBUGS</code> but this value is one, the sampler
actually ran sequentially.</p></li>
<li><p><code>mcmc</code><br>
List of MCMC configuration parameters. It includes all MCMC-related
arguments passed when calling <code>juliaBUGS</code>.</p></li>
<li><p><code>control</code><br>
Control options used in the sampler setup. For more details, see the
documentation of <code><a href="../reference/juliaBUGS.html">?juliaBUGS</a></code>.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="visualizing-posteriors">Visualizing Posteriors<a class="anchor" aria-label="anchor" href="#visualizing-posteriors"></a>
</h2>
<p>Once the posterior samples are obtained, further diagnostic and
visualization tools are easily accessible through well-known packages
such as <code>bayesplot</code> and <code>posterior</code>. For a full
walkthrough of visualizations and diagnostics, check the other vignette
(currently in progress).</p>
<p>For a quick illustration, let‚Äôs observe the density plot of the
posteriors and their traceplots.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting the posterior density for the saved parameters</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html" class="external-link">mcmc_areas</a></span><span class="op">(</span></span>
<span>  <span class="va">posterior</span><span class="op">$</span><span class="va">params</span>,</span>
<span>  pars <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha0"</span>, <span class="st">"alpha1"</span>, <span class="st">"alpha2"</span>, <span class="st">"alpha12"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="rjuliabugs_files/figure-html/bayes_plotposterior-1.png" width="600" style="display: block; margin: auto;"></p>
<p>For the traceplots, we subset only the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ±</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\alpha_{0}</annotation></semantics></math>
and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÉ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
parameters:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting traceplots for alpha0 and sigma</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html" class="external-link">mcmc_trace</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">posterior</span><span class="op">$</span><span class="va">params</span>,</span>
<span>  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha0"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>  n_warmup <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="rjuliabugs_files/figure-html/bayes_traceplot-1.png" width="600" style="display: block; margin: auto;"></p>
<p>Similarly, diagnostics are also available from the posterior
package:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/" class="external-link">posterior</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For other diagnostics, see the help page</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="st">"diagnostics"</span>, <span class="st">"posterior"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example: effective sample size</span></span>
<span><span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/ess_basic.html" class="external-link">ess_basic</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">$</span><span class="va">params</span><span class="op">[</span>,,<span class="st">"alpha0"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2890.269</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="saving-and-loading-the-rjuliabugs-model">Saving and loading the <code>rjuliabugs</code> model<a class="anchor" aria-label="anchor" href="#saving-and-loading-the-rjuliabugs-model"></a>
</h2>
<p>Lastly, it is important to be able to save and load a
<code>rjuliabugs</code> model. To do it so we will use the
<code><a href="../reference/save_rjuliabugs.html">save_rjuliabugs()</a></code> to save the <code>posterior</code>
object</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_rjuliabugs.html">save_rjuliabugs</a></span><span class="op">(</span>rjuliabugs_model <span class="op">=</span> <span class="va">posterior</span>,</span>
<span>                file <span class="op">=</span> <span class="st">"rjuliabugs_model.rds"</span>,</span>
<span>                chains_file <span class="op">=</span> <span class="st">"rjuliabugs_chains.jls"</span><span class="op">)</span></span></code></pre></div>
<p>and, to load we use <code><a href="../reference/load_rjuliabugs.html">load_rjuliabugs()</a></code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_rjuliabugs.html">load_rjuliabugs</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"rjuliabugs_model.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mateus Maia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting `rjuliabugs` draws using bayesplot package • rjuliabugs</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting `rjuliabugs` draws using bayesplot package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rjuliabugs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/rjuliabugs.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/rjuliabugs_parallel.html">Using rjuliabugs in parallel</a></li>
    <li><a class="dropdown-item" href="../articles/setup_troubleshooting.html">Using rjuliabugs: Setup and Troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/using_bayesplot.html">Plotting `rjuliabugs` draws using bayesplot package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plotting `rjuliabugs` draws using bayesplot package</h1>
            
      

      <div class="d-none name"><code>using_bayesplot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This article focuese on plotting the parameter estimates from the
MCMC draws obtained with the <code><a href="../reference/juliaBUGS.html">rjuliabugs::juliaBUGS()</a></code>
sampler. We do not cover the MCMC diagnostics, neither other
visualizations tools or packages, although they could be easily adapted
with as we work with the <code>params</code> array from from the
<code>rjuliabugs object</code>. The plots showed here are the same as
the ones described in the original vignette of Jonah Habry and Martin
Modrák and we recommend the read of their article <a href="https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html" class="external-link uri">https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html</a>,
from each most of the code and plot here as the same as presented by
them.</p>
<p>For a initial setup we call the necessary models to visualize the
examples</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mateusmaiads.github.io/rjuliabugs/">rjuliabugs</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>As previously mentioned the goal of this vignette is exclusively to
show how to use and present some of the visualizations tools from
samples obtained from the sampler from <code>rjuliabugs</code>.
Therefore we will assume that the <code>rjuliabugs</code> model object
is already fitted and named as `rjuliabugs_fit``. For a full walkthrough
until this moment, please refer to the article named <a href="https://mateusmaiads.github.io/rjuliabugs/articles/rjuliabugs.html">Get
Started</a> until the section where we generate the <a href="https://mateusmaiads.github.io/rjuliabugs/articles/rjuliabugs.html#inference-running-the-sampler">posterior
draws from the sampler</a></p>
<div class="section level3">
<h3 id="inspect-the-params-object-">Inspect the <code>params</code> object.<a class="anchor" aria-label="anchor" href="#inspect-the-params-object-"></a>
</h3>
<p>The <code>rjuliabugs</code> is a <code>S3 object</code> which
contains all the information and data used in the sampler. This
includes, from the the the name of identify the model object in the
<code>Julia</code> environment, the <code>mcmc</code> configuration
parameters to the posterior draws named as <code>params</code> which by
default is given by an 3D numeric array with respective dimensions being
(iterations chains parameters). The choice of array as the default is
due to its compatibility with most of other packages in <code>R</code>
enviroment to work with posterior samplers. However, the converstion to
other types to be comptabilite to other packages is possible through the
functions <code>as_rvar</code>, <code>as_mcmc</code> and
<code>as_draws</code> which can be called over the model object itself
(<code>as_rvar(rjuliabugs)</code>) or the <code>rjuliabugs$params</code>
object (<code>as_rvar(juliabugs$params</code>). See the <a href="https://mateusmaiads.github.io/rjuliabugs/reference/index.html#converting-posterior-sample-formats">reference</a>
section for a complete documentation of the examples.</p>
<pre><code><span><span class="co">#&gt; Preparing JuliaBUGS setup... DONE!</span></span>
<span><span class="co">#&gt; Initialising AbstractMCMC.sample()... DONE!</span></span></code></pre>
<p>Verifying the dimensions of the <code>params</code> object we would
have</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2000    4    5</span></span></code></pre></div>
<p>we have a total of 2000 iterations, 4 chains and 5 parameters that
were stored.</p>
</div>
</div>
<div class="section level2">
<h2 id="posterior-uncertainty-intervals">Posterior uncertainty intervals<a class="anchor" aria-label="anchor" href="#posterior-uncertainty-intervals"></a>
</h2>
<p>Central credible intervals from the posterior distribution can be
visualized using the <code>mcmc_intervals</code> function.</p>
<div class="section level3">
<h3 id="mcmc_intervals">
<code>mcmc_intervals</code><a class="anchor" aria-label="anchor" href="#mcmc_intervals"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html" class="external-link">mcmc_intervals</a></span><span class="op">(</span><span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span>, pars <span class="op">=</span>  <span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">mcmc</span><span class="op">$</span><span class="va">params_to_save</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_bayesplot_files/figure-html/mcmc_intervals-1.png" width="600" style="display: block; margin: auto;"></p>
<p>By default, the plot displays 50% credible intervals as bold lines
and 90% intervals as thinner outer segments. These settings can be
adjusted using the <code>prob</code> and <code>prob_outer</code>
parameters, respectively. The plotted points represent the posterior
medians; if preferred, the <code>point_est</code> option allows
switching to posterior means or suppressing point estimates
entirely.</p>
<p>To represent uncertainty with shaded regions beneath the posterior
density estimates, the <code>mcmc_areas</code> function can be
employed.</p>
</div>
<div class="section level3">
<h3 id="mcmc_intervals-1">
<code>mcmc_intervals</code><a class="anchor" aria-label="anchor" href="#mcmc_intervals-1"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html" class="external-link">mcmc_areas</a></span><span class="op">(</span></span>
<span>  <span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span>, </span>
<span>  pars <span class="op">=</span> <span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">mcmc</span><span class="op">$</span><span class="va">params_to_save</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.8</span>, <span class="co"># 80% intervals</span></span>
<span>  prob_outer <span class="op">=</span> <span class="fl">0.99</span>, <span class="co"># 99%</span></span>
<span>  point_est <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="using_bayesplot_files/figure-html/mcmc_areas-1.png" width="600" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="mcmc_areas_ridges">
<code>mcmc_areas_ridges</code><a class="anchor" aria-label="anchor" href="#mcmc_areas_ridges"></a>
</h3>
<p>We can also generate additional plots with by calling
<code>mcmc_areas_ridges</code></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html" class="external-link">mcmc_areas_ridges</a></span><span class="op">(</span></span>
<span>  <span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span>, </span>
<span>  pars <span class="op">=</span> <span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">mcmc</span><span class="op">$</span><span class="va">params_to_save</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.8</span>, <span class="co"># 80% intervals</span></span>
<span>  prob_outer <span class="op">=</span> <span class="fl">0.99</span>, <span class="co"># 99%</span></span>
<span>  point_est <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="using_bayesplot_files/figure-html/mcmc_areas_ridges-1.png" width="600" style="display: block; margin: auto;">
## Univariate marginal posterior distributions</p>
<p>The <code>bayesplot</code> package includes functions for visualizing
marginal posterior distributions through histograms or kernel density
estimates, either by merging all Markov chains or displaying them
individually.</p>
</div>
<div class="section level3">
<h3 id="mcmc_hist">
<code>mcmc_hist</code><a class="anchor" aria-label="anchor" href="#mcmc_hist"></a>
</h3>
<p>The <code>mcmc_hist</code> function plots marginal posterior
distributions (combining all chains):</p>
<pre class="mcmc_hist"><code><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html" class="external-link">mcmc_hist</a></span><span class="op">(</span><span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha0"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="mcmc_hist_by_chain">
<code>mcmc_hist_by_chain</code><a class="anchor" aria-label="anchor" href="#mcmc_hist_by_chain"></a>
</h2>
<p>To visualize individual histograms for each of the four Markov
chains, the <code>mcmc_hist_by_chain</code> function can be used; it
generates separate facets for each chain within the plot.</p>
<pre class="mcmc_hist_chain"><code><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"darkgreen"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html" class="external-link">mcmc_hist_by_chain</a></span><span class="op">(</span><span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha0"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>If we are interested in also display a transformation for display any
of the histograms, this is possible by setting the
<code>transformations</code> argument.</p>
<pre class="mcmc_hist_chain_transform"><code><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"darkgreen"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html" class="external-link">mcmc_hist_by_chain</a></span><span class="op">(</span><span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha0"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>                   transformations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sigma"</span> <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>Many of the plotting functions for MCMC draws also include a
<code>transformations</code> argument to apply transformations to the
parameters before plotting.</p>
<div class="section level3">
<h3 id="mcmc_dens">
<code>mcmc_dens</code><a class="anchor" aria-label="anchor" href="#mcmc_dens"></a>
</h3>
<p>The <code>mcmc_dens</code> function works similarly to
<code>mcmc_hist</code>, but it displays kernel density estimates in
place of histograms. This include a version of
<code>mcmc_dens_by_chain</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"brightblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html" class="external-link">mcmc_dens</a></span><span class="op">(</span><span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha0"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_bayesplot_files/figure-html/mcmc_dens-1.png" width="600" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="mcmc_dens_overlay">
<code>mcmc_dens_overlay</code><a class="anchor" aria-label="anchor" href="#mcmc_dens_overlay"></a>
</h3>
<p>Similar to <code>mcmc_hist_by_chain</code>, the
<code>mcmc_dens_overlay</code> function distinguishes between Markov
chains; however, rather than showing them in separate panels, it
overlays their density estimates in a single plot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html" class="external-link">mcmc_dens_overlay</a></span><span class="op">(</span><span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha0"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_bayesplot_files/figure-html/mcmc_dens_overlay-1.png" width="600" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="mcmc_violin">
<code>mcmc_violin</code><a class="anchor" aria-label="anchor" href="#mcmc_violin"></a>
</h3>
<p>The <code>mcmc_violin</code> function visualizes the density
estimates for each chain using violin plots and adds horizontal lines at
quantiles specified by the user.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"teal"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html" class="external-link">mcmc_violin</a></span><span class="op">(</span><span class="va">rjuliabugs_fit</span><span class="op">$</span><span class="va">params</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha0"</span>, <span class="st">"alpha12"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_bayesplot_files/figure-html/mcmc_violion-1.png" width="600" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="bivariate-plots">Bivariate plots<a class="anchor" aria-label="anchor" href="#bivariate-plots"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mateus Maia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
